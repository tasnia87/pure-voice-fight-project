{"version":3,"sources":["admin.tincan.report.tab.min.js"],"names":["jQuery","document","ready","$","ResetModules","children","each","i","this","remove","ResetModulesXAPI","ResetCourses","ResetCoursesXAPI","insertParam","key","value","console","log","encodeURI","x","kvp","location","search","substr","split","length","join","change","find","val","click","e","fields","index","value_top","tc_filter_date_range","data","action","tc_filter_course","post","reportingApiSetup","ajaxurl","response","append","type","isAdmin","tc_filter_group","$indicator","css","addClass","select2","ajax","url","dataType","delay","params","q","term","page","cache","placeholder","id","text","allowClear","minimumInputLength"],"mappings":"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","file":"admin.tincan.report.tab.min.js","sourcesContent":["/**\r\n * @package Uncanny TinCan API\r\n * @author Uncanny Owl\r\n * @version 1.0.0\r\n */\r\n\r\njQuery( document ).ready( function($) {\r\n\t// Per Page\r\n\t$( '#tincan-filters-per_page select' ).change( function() {\r\n\t\tconsole.log('changed per page select');\r\n\t\tvar value = $(this).find( 'option:selected' ).val();\r\n\r\n\t\tinsertParam( 'per_page', value );\r\n\t});\r\n\r\n\t// <!-- Change Date Range Type\r\n\t$( '#tincan-filters-top #tc_filter_date_range_last' ).click( function() {\r\n\t\t$( '#tincan-filters-top input[name=\"tc_filter_date_range\"][value=\"last\"]' ).click();\r\n\t});\r\n\r\n\t$( '#tincan-filters-top input[name=\"tc_filter_start\"], #tincan-filters-top input[name=\"tc_filter_end\"]' ).click( function() {\r\n\t\t$( '#tincan-filters-top input[name=\"tc_filter_date_range\"][value=\"from\"]' ).click();\r\n\t});\r\n\r\n\t$( '#xapi-filters-top #tcx_filter_date_range_last' ).click( function() {\r\n\t\t$( '#xapi-filters-top input[name=\"tc_filter_date_range\"][value=\"last\"]' ).click();\r\n\t});\r\n\r\n\t$( '#xapi-filters-top input[name=\"tc_filter_start\"], #xapi-filters-top input[name=\"tc_filter_end\"]' ).click( function() {\r\n\t\t$( '#xapi-filters-top input[name=\"tc_filter_date_range\"][value=\"from\"]' ).click();\r\n\t});\r\n\t// Change Date Range Type -->\r\n\r\n\t// CSV Export\r\n\t$( '#do_tc_export_csv' ).click( function( e ) {\r\n\t\tvar fields = [ 'tc_filter_group', 'tc_filter_user', 'tc_filter_course', 'tc_filter_lesson', 'tc_filter_module', 'tc_filter_action', 'tc_filter_date_range', 'tc_filter_date_range_last', 'tc_filter_start', 'tc_filter_end' ];\r\n\r\n\t\t$.each( fields, function( index, value ) {\r\n\t\t\tvar value_top = $( '#tincan-filters-top [name=\"' + value + '\"]' ).val();\r\n\r\n\t\t\t$( '#tincan-filters-bottom [name=\"' + value + '\"]' ).val( value_top );\r\n\t\t});\r\n\r\n\t\tvar tc_filter_date_range = $( '#tincan-filters-top input[name=\"tc_filter_date_range\"]:checked' ).val();\r\n\r\n\t\tif ( typeof tc_filter_date_range != 'undefined' ) {\r\n\t\t\t$( '#tincan-filters-bottom input[name=\"tc_filter_date_range\"]' ).val( tc_filter_date_range );\r\n\t\t} else {\r\n\t\t\t$( '#tincan-filters-bottom input[name=\"tc_filter_date_range\"]' ).val( '' );\r\n\t\t}\r\n\t});\r\n\r\n    // CSV Export\r\n    $( '#do_tc_export_csv_xapi' ).click( function( e ) {\r\n        var fields = [ 'tc_filter_group', 'tc_filter_user', 'tc_filter_course', 'tc_filter_lesson', 'tc_filter_module', 'tc_filter_action', 'tc_filter_quiz', 'tc_filter_results', 'tc_filter_date_range', 'tc_filter_date_range_last', 'tc_filter_start', 'tc_filter_end' ];\r\n\r\n        $.each( fields, function( index, value ) {\r\n            var value_top = $( '#xapi-filters-top [name=\"' + value + '\"]' ).val();\r\n\r\n            $( '#xapi-filters-bottom [name=\"' + value + '\"]' ).val( value_top );\r\n        });\r\n\r\n        var tc_filter_date_range = $( '#xapi-filters-top input[name=\"tc_filter_date_range\"]:checked' ).val();\r\n\r\n        if ( typeof tc_filter_date_range != 'undefined' ) {\r\n            $( '#xapi-filters-bottom input[name=\"tc_filter_date_range\"]' ).val( tc_filter_date_range );\r\n        } else {\r\n            $( '#xapi-filters-bottom input[name=\"tc_filter_date_range\"]' ).val( '' );\r\n        }\r\n    });\r\n\r\n\t// Ajax : Modules from Course\r\n\t$( '#tincan-filters-top select[name=\"tc_filter_course\"]' ).change( function() {\r\n\t\tif ( !$(this).val() ) {\r\n\t\t\tResetModules();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar data = {\r\n\t\t\t'action': 'GET_Modules',\r\n\t\t\t'tc_filter_course' : $( this ).val()\r\n\t\t};\r\n\r\n\t\t$.post( reportingApiSetup.ajaxurl, data, function( response ) {\r\n\t\t\t// Do Something\r\n\r\n\t\t\tResetModules();\r\n\t\t\t$( '#tincan-filters-top select[name=\"tc_filter_module\"]' ).append( response );\r\n\t\t});\r\n\t});\r\n\r\n\t// Ajax : Modules from Course\r\n\t$( '#xapi-filters-top select[name=\"tc_filter_course\"]' ).change( function() {\r\n\t\tif ( !$(this).val() ) {\r\n            ResetModulesXAPI();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar data = {\r\n\t\t\t'action': 'GET_Modules',\r\n            'type'  : 'quiz',\r\n\t\t\t'tc_filter_course' : $( this ).val()\r\n\t\t};\r\n\r\n\t\t$.post( reportingApiSetup.ajaxurl, data, function( response ) {\r\n\t\t\t// Do Something\r\n\r\n            ResetModulesXAPI();\r\n\t\t\t$( '#xapi-filters-top select[name=\"tc_filter_module\"]' ).append( response );\r\n\t\t});\r\n\t});\r\n\r\n\tif( reportingApiSetup.isAdmin == \"\" ) {\r\n        // Ajax : Modules from Course\r\n        $('#tincan-filters-top select[name=\"tc_filter_group\"]').change(function () {\r\n            if (!$(this).val()) {\r\n                ResetCourses();\r\n                return;\r\n            }\r\n\r\n            var data = {\r\n                'action': 'GET_Courses',\r\n                'tc_filter_group': $(this).val()\r\n            };\r\n\r\n            $.post(reportingApiSetup.ajaxurl, data, function (response) {\r\n                // Do Something\r\n\r\n                ResetCourses();\r\n                $('#tincan-filters-top select[name=\"tc_filter_course\"]').append(response);\r\n            });\r\n        });\r\n\r\n        // Ajax : Modules from Course\r\n        $('#xapi-filters-top select[name=\"tc_filter_group\"]').change(function () {\r\n            if (!$(this).val()) {\r\n                ResetCoursesXAPI();\r\n                return;\r\n            }\r\n\r\n            var data = {\r\n                'action': 'GET_Courses',\r\n                'type': 'quiz',\r\n                'tc_filter_group': $(this).val()\r\n            };\r\n\r\n            $.post(reportingApiSetup.ajaxurl, data, function (response) {\r\n                // Do Something\r\n\r\n                ResetCoursesXAPI();\r\n                $('#xapi-filters-top select[name=\"tc_filter_course\"]').append(response);\r\n            });\r\n        });\r\n    }\r\n\t// Change Sorting Indicator\r\n\t$( '.uo-admin-reporting-tab-single#tin-can table.wp-list-table thead th' ).each( function() {\r\n\t\tvar $indicator = $(this).find( '.sorting-indicator' );\r\n\r\n\t\tif ( $indicator.css( 'visibility' ) == 'hidden' ) {\r\n\t\t\t$indicator.addClass( 'double-headed-triangles' );\r\n\t\t}\r\n\t});\r\n\r\n\tfunction ResetModules() {\r\n\t\t$( '#tincan-filters-top select[name=\"tc_filter_module\"]' ).children().each( function (i) {\r\n\t\t\tif ( i !== 0 ) $(this).remove();\r\n\t\t});\r\n\t}\r\n\r\n\tfunction ResetModulesXAPI() {\r\n\t\t$( '#xapi-filters-top select[name=\"tc_filter_module\"]' ).children().each( function (i) {\r\n\t\t\tif ( i !== 0 ) $(this).remove();\r\n\t\t});\r\n\t}\r\n\r\n    function ResetCourses() {\r\n        $( '#tincan-filters-top select[name=\"tc_filter_course\"]' ).children().each( function (i) {\r\n            if ( i !== 0 ) $(this).remove();\r\n        });\r\n    }\r\n\r\n    function ResetCoursesXAPI() {\r\n        $( '#xapi-filters-top select[name=\"tc_filter_course\"]' ).children().each( function (i) {\r\n            if ( i !== 0 ) $(this).remove();\r\n        });\r\n    }\r\n\r\n\tfunction insertParam(key, value)\r\n\t{\r\n\t\tconsole.log('inserting param');\r\n\t\tconsole.log([key, value]);\r\n\t    key = encodeURI(key); value = encodeURI(value);\r\n\r\n\t    var kvp = document.location.search.substr(1).split('&');\r\n\r\n\t    var i=kvp.length; var x; while(i--)\r\n\t    {\r\n\t        x = kvp[i].split('=');\r\n\r\n\t        if (x[0]==key)\r\n\t        {\r\n\t            x[1] = value;\r\n\t            kvp[i] = x.join('=');\r\n\t            break;\r\n\t        }\r\n\t    }\r\n\r\n\t    if(i<0) {kvp[kvp.length] = [key,value].join('=');}\r\n\r\n\t    //this will reload the page, it's likely better to store this until finished\r\n\t    document.location.search = kvp.join('&');\r\n\t}\r\n\r\n    $(\"#tc_filter_quiz\").select2({\r\n        ajax: {\r\n            url: reportingApiSetup.ajaxurl,\r\n            dataType: 'json',\r\n            type: 'POST',\r\n            delay: 250,\r\n            data: function (params) {\r\n                return {\r\n                    q: params.term, // search term\r\n                    page: params.page,\r\n                    action: 'GET_Questions'\r\n                };\r\n            },\r\n\r\n            cache: true\r\n        },\r\n        placeholder: {\r\n            id: '1', // the value of the option\r\n            text: 'All Questions'\r\n        },\r\n        allowClear: true,\r\n        minimumInputLength: 1\r\n    });\r\n\r\n});"]}