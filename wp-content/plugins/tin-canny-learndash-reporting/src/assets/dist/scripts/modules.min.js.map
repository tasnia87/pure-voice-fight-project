{"version":3,"sources":["modules.min.js"],"names":["tincannyModuleController","$this","this","count","completion","bound","hasCompletionSetting","markCompleteSettings","markCompleteLesson","markCompleteCourse","markCompleteLabel","currentLessonLink","iframe_interval","moduleFunctions","tincannyModuleFunctions","ready","iFrameReady","lightboxReady","newWindowReady","setButton","checkH5PCompletiton","edgeReload","jQuery","css","addClass","remove","is_empty","is_complete","Object","keys","forEach","key","undefined","length","prop","removeClass","removeAttr","tinCanny","doAction","bind","checkStatues","contentWindow","targetURL","src","attr","unload","checkCompletion","bindNewWindow","targetWin","document","getElementsByTagName","URL","indexOf","setTimeout","click","e","preventDefault","url","window","popup","close","open","onbeforeunload","navigator","userAgent","location","reload","replaceRequest","contentType","XMLHttpRequest","prototype","oldSend","send","newSend","statement","err","getContentType","stop","regEx","idResult","exec","id","parseInt","json","JSON","parse","data","action","course_id","lesson_id","setting_option","lesson_link","post","wp_ajax_url","response","href","redirect_to","markComplete","patternModuleId","resultModuleId","markCompleted","moduleController","captivateFunctions","tincannyCaptivateFunctions","storylineFunctions","tincannyStorylineFunctions","openMethod","contentsType","processCaptivate","OnSendComplete","commObj","frame","DoCPExit","on","initializeCP","H5P","ajaxComplete","event","xhr","settings","WP_H5P_XAPI_STATEMENT_URL","verb","match","eval","unescape","object","definition","extensions","responseJSON","message","win","initialized","initCalled","cp","pg","deviceReady","cpInit","body","innerHTML","DoCPInit","lCpExit","targetWinDoCPExit","closeOverlay","UnloadActivties","win_","parent","top","self","closeWindow","elements","getElementsByClassName","parentNode","removeChild","MessageType","TYPE_RESUME_RESTORE","GetPlayer","SetTinCanResume","responseText","g_bWaitingTinCanResponse","g_oCurrentRequest","g_arrTinCanMsgQueue","g_bStopPosting","SendRequest","shift","context"],"mappings":"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","file":"modules.min.js","sourcesContent":["/**\r\n * @package Uncanny TinCan API\r\n * @author Uncanny Owl\r\n * @version 1.0.0\r\n */\r\n\r\nvar tincannyModuleController = function() {\r\n\tvar $this = this;\r\n\tthis.count = {};\r\n\tthis.completion = {};\r\n\tthis.bound = false;\r\n\tthis.hasCompletionSetting = false;\r\n\tthis.markCompleteSettings = '';\r\n\tthis.markCompleteLesson = 0;\r\n\tthis.markCompleteCourse = 0;\r\n\tthis.markCompleteLabel  = '';\r\n\tthis.currentLessonLink  = '';\r\n    $this.iframe_interval = false;\r\n\r\n\tvar moduleFunctions = new tincannyModuleFunctions(this);\r\n\r\n\tthis.ready = function() {\r\n\t\tthis.iFrameReady();\r\n\t\tthis.lightboxReady();\r\n\t\tthis.newWindowReady();\r\n\t\tthis.setButton(false);\r\n\r\n\t\tmoduleFunctions.checkH5PCompletiton();\r\n\t};\r\n\r\n\tthis.setButton = function(edgeReload) {\r\n\r\n\t    // We are setting display none with styles initial in tin-canny-learndash-reporting\\src\\uncanny-articulate-and-captivate\\classes\\Shortcode.php\r\n        // Lets reinstate display none before we run checks\r\n        jQuery( 'form[id=sfwd-mark-complete]' ).css( 'display', 'block' );\r\n        jQuery( '.sfwd-mark-complete' ).css( 'display', 'block' );\r\n        jQuery( '.tclr-mark-complete-button' ).css( 'display', 'block' ).addClass( 'tclr-mark-complete-button--visible' );\r\n\r\n\t\t// Check if no button needed\r\n\t\tif( this.markCompleteSettings === 'remove' || this.markCompleteSettings === 'autoadvance' ){\r\n            jQuery( 'form[id=sfwd-mark-complete]' ).remove();\r\n            jQuery( '.sfwd-mark-complete' ).remove();\r\n            return;\r\n\t\t}\r\n\r\n\t\t// Condition : No Module\r\n\t\tvar is_empty    = true;\r\n\t\tvar is_complete = false;\r\n\r\n\t\tObject.keys( this.count ).forEach( function( key ) {\r\n\t\t\tif ( $this.count[ key ] !== undefined )\r\n\t\t\t\tis_empty = false;\r\n\t\t});\r\n\r\n\t\t// Condition : Any Completion\r\n\t\tObject.keys( $this.count ).forEach( function( key ) {\r\n\t\t\tif ( $this.count[ key ] > 0 && Object.keys( $this.completion[ key ] ).length > 0 )\r\n\t\t\t\tis_complete = true;\r\n\t\t});\r\n\r\n        if ( is_empty ) {\r\n            // Legacy\r\n            jQuery( '#sfwd-mark-complete input' ).prop( 'disabled', false );\r\n            jQuery( '#sfwd-mark-complete input' ).removeClass( 'disabled' );\r\n\r\n            // 3.0\r\n            jQuery( '.sfwd-mark-complete input' ).removeAttr( 'disabled' );\r\n            jQuery( '.sfwd-mark-complete input' ).removeClass( 'disabled' );\r\n\r\n            // Hide option\r\n            if( this.markCompleteSettings == 'hide' ){\r\n                jQuery( '.tclr-mark-complete-button' ).css( 'display', 'block' ).addClass( 'tclr-mark-complete-button--visible' );\r\n            }\r\n        } else if ( is_complete ) {\r\n            // Legacy\r\n            jQuery( '#sfwd-mark-complete input' ).prop( 'disabled', false );\r\n            jQuery( '#sfwd-mark-complete input' ).removeClass( 'disabled' );\r\n\r\n            // 3.0\r\n            jQuery( '.sfwd-mark-complete input' ).prop( 'disabled', false );\r\n            jQuery( '.sfwd-mark-complete input' ).removeClass( 'disabled' );\r\n\r\n            // Hide option\r\n            if( this.markCompleteSettings == 'hide' ){\r\n                jQuery( '.tclr-mark-complete-button' ).css( 'display', 'block' ).addClass( 'tclr-mark-complete-button--visible' );\r\n            }\r\n\r\n            tinCanny.doAction( 'after_tincanny_insert_list' );\r\n\r\n        } else {\r\n            // Legacy\r\n            jQuery( '#sfwd-mark-complete input' ).prop( 'disabled', true );\r\n            jQuery( '#sfwd-mark-complete input' ).addClass( 'disabled' );\r\n\r\n            // 3.0\r\n            jQuery( '.sfwd-mark-complete input' ).prop( 'disabled', true );\r\n            jQuery( '.sfwd-mark-complete input' ).addClass( 'disabled' );\r\n\r\n            // Hide option\r\n            if( this.markCompleteSettings == 'hide' ){\r\n            \tjQuery( '.tclr-mark-complete-button' ).css( 'display', 'none' ).removeClass( 'tclr-mark-complete-button--visible' );\r\n\t\t\t}\r\n        }\r\n\t};\r\n\r\n\tthis.iFrameReady = function() {\r\n\t\tjQuery('.AnC-iFrame').bind('ready load', function() {\r\n\t\t\tmoduleFunctions.checkStatues(jQuery(this)[0].contentWindow, 'iFrame');\r\n\t\t});\r\n\t};\r\n\r\n\tthis.lightboxReady = function() {\r\n\t\tjQuery('body').bind('DOMSubtreeModified', function() {\r\n\t\t\tjQuery('.nivo-lightbox-item').bind('load', function() {\r\n\t\t\t\tvar targetURL = jQuery(this)[0].src;\r\n\r\n\t\t\t\tif (!jQuery(this).attr('data-tcloaded')) {\r\n\t\t\t\t\tmoduleFunctions.checkStatues(jQuery(this)[0].contentWindow, 'lightbox');\r\n\t\t\t\t\tjQuery(this).attr('data-tcloaded', true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tjQuery(jQuery(this)[0].contentWindow).unload(function() {\r\n\t\t\t\t\t$this.checkCompletion(targetURL, 'Authorization=LearnDashIdstateId=');\r\n                    /* clearInterval( $this.iframe_interval ); */\r\n\t\t\t\t});\r\n                /*$this.iframe_interval = setInterval(function () {\r\n                    $this.checkCompletion(targetURL, 'Authorization=LearnDashIdstateId=');\r\n                }, 5000);*/\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\tthis.newWindowReady = function() {\r\n\t\tvar bindNewWindow = function(targetWin) {\r\n\t\t\t// jQuery( \"body\" ).append( document.createTextNode( \", Ready\" ) );\r\n\t\t\tif ($this.bound)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif (\r\n\t\t\t\t!targetWin.document.getElementsByTagName('meta') ||\r\n\t\t\t\t!targetWin.document.URL ||\r\n\t\t\t\ttargetWin.document.URL.indexOf('uncanny-snc') == -1\r\n\t\t\t) {\r\n\t\t\t\t// jQuery( \"body\" ).append( document.createTextNode( \", Not Ready\" ) );\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tbindNewWindow(targetWin);\r\n\t\t\t\t}, 500);\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tmoduleFunctions.checkStatues( targetWin, 'blank' );\r\n\t\t};\r\n\r\n\t\tjQuery('.AnC-Link').click(function(e) {\r\n\t\t\t// jQuery( \"body\" ).append( document.createTextNode( \", Click\" ) );\r\n\r\n\t\t\tif (jQuery(this).attr('target') == '_blank' ) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tvar url = jQuery(this).attr('href');\r\n\r\n\t\t\t\tif (window.popup) {\r\n\t\t\t\t\t// jQuery( \"body\" ).append( document.createTextNode( \", Close\" ) );\r\n\t\t\t\t\twindow.popup.close();\r\n\t\t\t\t}\r\n\r\n\t\t\t\twindow.popup = open(url, 'AnC');\r\n\t\t\t\t// jQuery( \"body\" ).append( document.createTextNode( \", Open\" ) );\r\n\r\n                jQuery(window.popup.document).ready(function() {\r\n                    // jQuery( \"body\" ).append( document.createTextNode( \", Doc Ready\" ) );\r\n                    $this.bound = false;\r\n                    // Removed immediate call and wait for a redirect completion.\r\n\t\t\t\t\t// bindNewWindow(window.popup);\r\n                    setTimeout(function() {\r\n                        bindNewWindow(window.popup);\r\n                    }, 5000);\r\n                });\r\n\r\n                /* This will not work in some browsers so removed.\r\n                window.popup.onbeforeunload = function(e) {\r\n                    // check condition\r\n                    setTimeout(function() {\r\n                        bindNewWindow(window.popup);\r\n                    }, 5000);\r\n                    return null;\r\n                };*/\r\n\r\n                window.onbeforeunload = function(e){\r\n                    if (window.popup) {\r\n                        window.popup.close();\r\n                    }\r\n                };\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\twindow.navigator.userAgent.indexOf(\"Edge\") >= 0 ||\r\n\t\t\t\t\twindow.navigator.userAgent.indexOf(\"MSIE\") >= 0 ||\r\n\t\t\t\t\twindow.navigator.userAgent.indexOf(\"Trident\") >= 0\r\n\t\t\t\t) {\r\n\t\t\t\t\t// jQuery( \"body\" ).append( document.createTextNode( \", Hello\" ) );\r\n\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\twindow.popup.onbeforeunload = function() {\r\n\t\t\t\t\t\t\t// jQuery( \"body\" ).append( document.createTextNode( \", Bye\" ) );\r\n\t\t\t\t\t\t\tlocation.reload();\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}, 1500);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tthis.replaceRequest = function( targetWin, targetURL, contentType ) {\r\n\t\ttargetWin.XMLHttpRequest.prototype.oldSend = targetWin.XMLHttpRequest.prototype.send;\r\n\r\n\t\tvar newSend = function( statement ) {\r\n\t\t\tthis.oldSend(statement);\r\n\r\n\t\t\ttry {\r\n\t\t\t\t$this.checkCompletion(targetURL, statement);\r\n\t\t\t} catch(err) {}\r\n\t\t};\r\n\r\n\t\ttargetWin.XMLHttpRequest.prototype.send = newSend;\r\n\t};\r\n\r\n\tthis.checkCompletion = function (targetURL, statement) {\r\n\t\tvar contentType = moduleFunctions.getContentType(targetURL);\r\n\r\n\t\tvar stop = true;\r\n\t\tvar regEx = /\\/uncanny-snc\\/([0-9]+)\\//;\r\n\t\tvar idResult = regEx.exec(targetURL);\r\n\t\tvar id = parseInt(idResult[1]);\r\n\r\n\r\n\t\tif (statement.indexOf('Authorization=LearnDashId') >= -1 && statement.indexOf('stateId=') >= -1) {\r\n\t\t\tstop = false;\r\n\t\t} else {\r\n\t\t\tvar json = JSON.parse(statement);\r\n\r\n\t\t\tif (typeof json === 'object')\r\n\t\t\t\tstop = false;\r\n\t\t}\r\n\r\n\t\tif ($this.completion[contentType][id])\r\n\t\t\tstop = true;\r\n\r\n\t\tif (stop)\r\n\t\t\treturn;\r\n\r\n\t\tvar data = {\r\n\t\t\t'action': 'Check ' + contentType + ' Completion',\r\n\t\t\t'URL': targetURL,\r\n            'course_id': this.markCompleteCourse,\r\n            'lesson_id': this.markCompleteLesson,\r\n            'setting_option': this.markCompleteSettings,\r\n            'lesson_link': this.currentLessonLink,\r\n            'contentType': contentType\r\n\t\t};\r\n\r\n\t\t// Check Completion\r\n\t\tjQuery.post( wp_ajax_url, data, function( response ) {\r\n\t\t\tif ( response ) {\r\n                if ( $this.markCompleteSettings === 'autoadvance') {\r\n                    response = JSON.parse(response);\r\n                \twindow.location.href = response.redirect_to;\r\n\t\t\t\t}\r\n\t\t\t\t$this.markComplete( contentType, targetURL );\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tthis.markComplete = function( contentType, targetURL ) {\r\n\t\tvar patternModuleId = /uncanny-snc\\/([0-9]+)\\//i;\r\n\t\tvar resultModuleId = patternModuleId.exec(targetURL);\r\n\r\n\t\tif ( resultModuleId[1] ) {\r\n\t\t\tthis.completion[ contentType ][ resultModuleId[1] ] = true;\r\n\t\t\tthis.setButton(true);\r\n            $this.markCompleted( contentType );\r\n\t\t}\r\n\t};\r\n\r\n    this.markCompleted = function (contentType) {\r\n        if ( this.markCompleteSettings === 'remove' || this.markCompleteSettings === 'autoadvance') {\r\n            var data = {\r\n                'action': 'uncanny-snc-mark-completed',\r\n                'course_id': this.markCompleteCourse,\r\n                'lesson_id': this.markCompleteLesson,\r\n                'setting_option': this.markCompleteSettings,\r\n\t\t\t\t'lesson_link': this.currentLessonLink,\r\n                'contentType': contentType\r\n            };\r\n\r\n            // Check Completion\r\n            jQuery.post(wp_ajax_url, data, function (response) {\r\n                if (response) {\r\n                \tif( typeof( response.redirect_to ) !== 'undefined' ) {\r\n                \t\twindow.location.href = response.redirect_to;\r\n                \t}\r\n                }\r\n            }, 'json' );\r\n        }\r\n    };\r\n};\r\n\r\nvar tincannyModuleFunctions = function(moduleController) {\r\n\tvar $this = this;\r\n\tvar captivateFunctions = new tincannyCaptivateFunctions();\r\n\tvar storylineFunctions = new tincannyStorylineFunctions(moduleController);\r\n\r\n\tthis.checkStatues = function( targetWin, openMethod ) {\r\n\t\tvar targetURL = targetWin.document.URL;\r\n\t\tvar contentsType = this.getContentType(targetURL);\r\n\r\n\t\t// Captivate\r\n\t\tif ( contentsType === 'Captivate' ) {\r\n\t\t\tthis.processCaptivate( targetWin, targetURL, openMethod );\r\n\t\t\treturn;\r\n\r\n\t\t// iSpring\r\n\t\t} else if ( contentsType === 'iSpring' ) {\r\n\t\t\tmoduleController.replaceRequest( targetWin, targetURL, 'iSpring' );\r\n\t\t\treturn;\r\n\r\n\t\t// Articulate Rise\r\n\t\t} else if ( contentsType === 'ArticulateRise' ) {\r\n\t\t\tmoduleController.replaceRequest( targetWin, targetURL, 'ArticulateRise' );\r\n\t\t\treturn;\r\n            /* add Presenter360 tin can format */\r\n        } else if ( contentsType === 'Presenter360' ) {\r\n            moduleController.replaceRequest( targetWin, targetURL, 'Presenter360' );\r\n            return;\r\n            /* END Presenter360 */\r\n            /* add Lectora tin can format */\r\n\t\t} else if ( contentsType === 'Lectora' ) {\r\n            moduleController.replaceRequest( targetWin, targetURL, 'Lectora' );\r\n            return;\r\n            /* END Lectora */\r\n        }\r\n\r\n\t\t// Storyline : Replace Function\r\n\t\tif ( targetWin.OnSendComplete ) {\r\n\t\t\ttargetWin.OnSendComplete = function( commObj ) {\r\n\t\t\t\tstorylineFunctions.OnSendComplete(targetWin, commObj);\r\n\t\t\t};\r\n\r\n\t\t} else {\r\n\t\t\tmoduleController.replaceRequest(targetWin, targetURL, 'Storyline');\r\n\t\t}\r\n\t};\r\n\r\n\tthis.getContentType = function(targetURL) {\r\n\t\tif ( targetURL.indexOf('Captivate') >= 0 ) {\r\n\t\t\treturn 'Captivate';\r\n\t\t} else if ( targetURL.indexOf('/res/') >= 0 ) {\r\n\t\t\treturn 'iSpring';\r\n\t\t} else if ( targetURL.indexOf('ArticulateRise') >= 0 ) {\r\n\t\t\treturn 'ArticulateRise';\r\n\t\t} else if ( targetURL.indexOf('ArticulateRise2017') >= 0 || targetURL.indexOf('AR2017') >= 0 ) {\r\n\t\t\treturn 'ArticulateRise2017';\r\n            /* add Presenter360 tin can format */\r\n        } else if ( targetURL.indexOf('Presenter360') >= 0 ) {\r\n            return 'Presenter360';\r\n            /* END Presenter360 */\r\n\t\t\t/* add Lectora tin can format */\r\n    \t} else if ( targetURL.indexOf('Lectora') >= 0 ) {\r\n        \treturn 'Lectora';\r\n        \t/* END Lectora */\r\n    \t}\r\n\r\n\t\treturn 'Storyline';\r\n\t};\r\n\r\n\tthis.processCaptivate = function( targetWin, targetURL, openMethod ) {\r\n\t\tvar frame;\r\n\r\n\t\tif ( targetURL.indexOf('multiscreen.html') >= 0 ) {\r\n\t\t\tframe = jQuery(targetWin.document)[0].getElementsByTagName('frame')[0];\r\n\r\n\t\t\tif ( frame.contentWindow.DoCPExit ) {\r\n\t\t\t\tmoduleController.replaceRequest( frame.contentWindow, targetURL, 'Captivate' );\r\n\r\n\t\t\t\tframe.contentWindow.DoCPExit = function() {\r\n\t\t\t\t\tcaptivateFunctions.DoCPExit( window, openMethod );\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tjQuery(frame).on( 'load ready', function() {\r\n\t\t\t\tmoduleController.replaceRequest( jQuery(this)[0].contentWindow, targetURL, 'Captivate' );\r\n\r\n\t\t\t\tjQuery(this)[0].contentWindow.DoCPExit = function() {\r\n\t\t\t\t\tcaptivateFunctions.DoCPExit( window, openMethod );\r\n\t\t\t\t};\r\n\t\t\t});\r\n\r\n\t\t// Captivate Normal : index_TINCAN.html\r\n\t\t} else if ( targetURL.indexOf('index_TINCAN.html') >= 0 ) {\r\n\t\t\tmoduleController.replaceRequest( targetWin, targetURL, 'Captivate' );\r\n\r\n\t\t\ttargetWin.initializeCP = function() {\r\n\t\t\t\tcaptivateFunctions.initializeCP( window, targetWin );\r\n\t\t\t};\r\n\r\n\t\t// Captivate From SCORM\r\n\t\t} else {\r\n\t\t\tframe = jQuery( targetWin );\r\n\r\n\t\t\tjQuery(frame).ready( function() {\r\n\t\t\t\tmoduleController.replaceRequest( targetWin, targetURL, 'Captivate' );\r\n\r\n\t\t\t\ttargetWin.DoCPExit = function() {\r\n\t\t\t\t\tcaptivateFunctions.DoCPExit( window, openMethod );\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tthis.checkH5PCompletiton = function() {\r\n\t\tif (!moduleController || !moduleController.count || moduleController.count.H5P <= 0)\r\n\t\t\treturn;\r\n\r\n\t\t// Detect Ajax Completion\r\n\t\tjQuery(document).ajaxComplete(function( event, xhr, settings ) {\r\n\t\t\t// Detect H5P xAPI\r\n\t\t\tif (settings.url === WP_H5P_XAPI_STATEMENT_URL) {\r\n\t\t\t\t// Get Verb\r\n\t\t\t\tvar verb = settings.data.match(/http%3A%2F%2Fadlnet.gov%2Fexpapi%2Fverbs%2F([a-z]+)/);\r\n\r\n\t\t\t\teval(unescape(settings.data));\r\n\t\t\t\tvar id = statement.object.definition.extensions['http://h5p.org/x-api/h5p-local-content-id'];\r\n\r\n\t\t\t\tif (!moduleController.hasCompletionSetting) {\r\n\t\t\t\t\tmoduleController.completion.H5P[ id ] = true;\r\n\t\t\t\t\tmoduleController.setButton(true);\r\n                    moduleController.markCompleted( 'H5P' );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( xhr.responseJSON.message == 'true' ) {\r\n\t\t\t\t\tmoduleController.completion.H5P[ id ] = true;\r\n\t\t\t\t\tmoduleController.setButton(true);\r\n                    moduleController.markCompleted( 'H5P' );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n};\r\n\r\nvar tincannyCaptivateFunctions = function() {\r\n\tvar $this = this;\r\n\r\n\tthis.initializeCP = function( win, targetWin ) {\r\n\t\tif( targetWin.initialized )\r\n\t\t\treturn;\r\n\r\n\t\ttargetWin.initCalled = true ;\r\n\r\n\t\tif( targetWin.cp && targetWin.cp.pg && targetWin.deviceReady === false)\r\n\t\t\treturn;\r\n\r\n\t\ttargetWin.cpInit = function() {\r\n\t\t\ttargetWin.document.body.innerHTML = \" <div class='cpMainContainer' id='cpDocument' style='left: 0px; top:0px;' >\t<div id='main_container' style='top:0px;position:absolute;width:100%;height:100%;'>\t<div id='projectBorder' style='top:0px;left:0px;width:100%;height:100%;position:absolute;display:block'></div>\t<div class='shadow' id='project_container' style='left: 0px; top:0px;width:100%;height:100%;position:absolute;overflow:hidden;' >\t<div id='project' class='cp-movie' style='width:100% ;height:100%;overflow:hidden;'>\t\t<div id='project_main' class='cp-timeline cp-main'>\t\t\t<div id='div_Slide' onclick='cp.handleClick(event)' style='top:0px; width:100% ;height:100% ;position:absolute;-webkit-tap-highlight-color: rgba(0,0,0,0);'></div>\t\t\t<canvas id='slide_transition_canvas'></canvas>\t\t</div>\t\t<div id='autoplayDiv' style='display:block;text-align:center;position:absolute;left:0px;top:0px;'>\t\t\t<img id='autoplayImage' src='' style='position:absolute;display:block;vertical-align:middle;'/>\t\t\t<div id='playImage' tabindex='9999' role='button' aria-label='play' onkeydown='cp.CPPlayButtonHandle(event)' onClick='cp.movie.play()' style='position:absolute;display:block;vertical-align:middle;'></div>\t\t</div>\t</div>\t<div id='toc' style='left:0px;position:absolute;-webkit-tap-highlight-color: rgba(0,0,0,0);'>\t</div>\t<div id='playbar' style='bottom:0px; position:fixed'>\t</div>\t<div id='cc' style='left:0px; position:fixed;visibility:hidden;pointer-events:none;' onclick='cp.handleCCClick(event)'>\t\t<div id='ccText' style='left:0px;float:left;position:absolute;width:100%;height:100%;'>\t\t<p style='margin-left:8px;margin-right:8px;margin-top:2px;'>\t\t</p>\t\t</div>\t\t<div id='ccClose' style='background-image:url(./assets/htmlimages/ccClose.png);right:10px; position:absolute;cursor:pointer;width:13px;height:11px;' onclick='cp.showHideCC()'>\t\t</div>\t</div>\t<div id='gestureIcon' class='gestureIcon'>\t</div>\t<div id='gestureHint' class='gestureHintDiv'>\t\t<div id='gImage' class='gesturesHint'></div>\t</div>\t<div id='pwdv' style='display:block;text-align:center;position:absolute;width:100%;height:100%;left:0px;top:0px'></div>\t<div id='exdv' style='display:block;text-align:center;position:absolute;width:100%;height:100%;left:0px;top:0px'></div>\t</div>\t</div></div><div id='blockUserInteraction' class='blocker' style='width:100%;height:100%;'>\t<table style='width:100%;height:100%;text-align:center;vertical-align:middle' id='loading' class='loadingBackground'>\t\t<tr style='width:100%;height:100%;text-align:center;vertical-align:middle'>\t\t\t<td style='width:100%;height:100%;text-align:center;vertical-align:middle'>\t\t\t\t<image id='preloaderImage'></image>\t\t\t\t<div id='loadingString' class='loadingString'>Loading...</div>\t\t\t</td>\t\t</tr>\t</table></div> <div id='initialLoading'></div>\";\r\n\r\n\t\t\ttargetWin.cp.DoCPInit();\r\n\t\t\ttargetWin.lCpExit = targetWin.DoCPExit;\r\n\r\n\t\t\ttargetWinDoCPExit = function() {\r\n\t\t\t\tif ( openMethod == 'iFrame' )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tif ( openMethod == 'lightbox' ) {\r\n\t\t\t\t\t$this.closeOverlay( win );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( targetWin.cp.UnloadActivties)\r\n\t\t\t\t\ttargetWin.cp.UnloadActivties();\r\n\r\n\t\t\t\ttargetWin.lCpExit();\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\ttargetWin.cpInit();\r\n\t\ttargetWin.initialized = true;\r\n\t};\r\n\r\n\tthis.DoCPExit = function( win, openMethod ) {\r\n\t\tif ( openMethod == 'iFrame' )\r\n\t\t\treturn;\r\n\r\n\t\tvar win_;\r\n\r\n\t\tif( win != win.parent && win.parent && win.parent.DoCPExit !== undefined ) {\r\n\t\t\twin.parent.DoCPExit();\r\n\r\n\t\t} else {\r\n\t\t\tif( win.top == self ) {\r\n\t\t\t\twin_ = win.open(\"\",\"_self\");\r\n\t\t\t\t$this.closeWindow( win_, openMethod );\r\n\r\n\t\t\t} else {\r\n\t\t\t\twin_ = win.top.open(\"\",\"_self\");\r\n\t\t\t\t$this.closeWindow( win_.top, openMethod );\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tthis.closeWindow = function( win, openMethod ) {\r\n\t\tif ( openMethod == 'lightbox' ) {\r\n\t\t\t$this.closeOverlay( win );\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( window.popup )\r\n\t\t\twindow.popup.close();\r\n\t\telse\r\n\t\t\twin.close();\r\n\t};\r\n\r\n\tthis.closeOverlay = function( win ) {\r\n\t\tvar elements = win.document.getElementsByClassName(\"nivo-lightbox-overlay\");\r\n\t\twhile(elements.length > 0){\r\n\t\t\telements[0].parentNode.removeChild(elements[0]);\r\n\t\t}\r\n\t};\r\n};\r\n\r\nvar tincannyStorylineFunctions = function(moduleController) {\r\n\tthis.OnSendComplete = function(targetWin, commObj) {\r\n\t\tif (commObj.MessageType == targetWin.TYPE_RESUME_RESTORE) {\r\n\t\t\ttargetWin.GetPlayer().SetTinCanResume(commObj.responseText);\r\n\t\t}\r\n\r\n\t\ttargetWin.g_bWaitingTinCanResponse = false;\r\n\t\ttargetWin.g_oCurrentRequest = null;\r\n\r\n\t\tif ( targetWin.g_arrTinCanMsgQueue.length > 0 && !targetWin.g_bStopPosting ) {\r\n\t\t\tvar test = targetWin.SendRequest(targetWin.g_arrTinCanMsgQueue.shift());\r\n\t\t}\r\n\r\n\t\tmoduleController.checkCompletion(jQuery(targetWin.document).context.URL, commObj.responseText);\r\n\t};\r\n};\r\n\r\nvar moduleController = new tincannyModuleController();\r\n\r\n/*\r\njQuery(document).ready(function() {\r\n\t// jQuery( \"body\" ).append( document.createTextNode( \"Global Ready\" ) );\r\n\r\n});\r\n*/\r\n"]}